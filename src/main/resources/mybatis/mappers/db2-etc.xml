<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.baron.member.sqlModel">

	<!-- 코드 관련 쿼리 -->
	<select id="selectdinner" resultType="String">
		SELECT MENU
		FROM
		SITLIB.SFOODTABLE
		WHERE GDATE = VARCHAR_FORMAT(CURRENT
		TIMESTAMP,
		'YYYYMMDD') AND GUBN = 'C'
	</select>
	<select id="selectlunch" resultType="String">
		SELECT MENU
		FROM
		SITLIB.SFOODTABLE
		WHERE GDATE = VARCHAR_FORMAT(CURRENT
		TIMESTAMP,
		'YYYYMMDD') AND GUBN = 'B'
	</select>
	<select id="selectbreakfast" resultType="String">
		SELECT MENU
		FROM
		SITLIB.SFOODTABLE
		WHERE GDATE = VARCHAR_FORMAT(CURRENT
		TIMESTAMP,
		'YYYYMMDD') AND GUBN = 'A'
	</select>

	<select id="copyDate" resultType="BookModel">
		SELECT
		Left(A.rece_ymd,
		4)||'-'||substring(A.rece_ymd,5,2)||'-'||substring(A.rece_ymd, 7,2) as
		rcv_date, book_cd from sitlib.bookmst A WHERE rece_ymd
		is not null AND
		price is not null AND rece_ymd != ''AND price!='0'
		ORDER BY RECE_YMD
		DESC, PRICE DESC
	</select>

	<update id="updateDate" parameterType="BookModel">
		UPDATE testlib.bookmst SET
		rcv_date = #{rcv_date} WHERE book_cd=#{book_cd}
	</update>


	<select id="copyRent" resultType="BookModel">

		SELECT DISTINCT A.SABUN AS id ,
		Left(A.req_ymd,
		4)||'-'||substring(A.req_ymd,5,2)||'-'||substring(A.req_ymd, 7,2) AS
		req_ymd,
		B.book_cd AS book_cd, Left(A.retu_ymd,
		4)||'-'||substring(A.retu_ymd,5,2)||'-'||substring(A.retu_ymd, 7,2) AS
		retu_ymd,
		A.dept_no AS dept_nm
		FROM sitlib.bookreq A INNER JOIN
		sitlib.bookreqhis
		B ON A.SABUN = B.SABUN AND A.req_ymd = B.req_ymd
	</select>

	<insert id="backupRecord" parameterType="BookModel">
		INSERT INTO
		TESTLIB.BOOKRENT
		(ID, RENTDATE, RETURNDATE, team_nm, book_cd)
		VALUES(#{id},
		#{rentdate},
		#{returndate}, #{team_nm}, #{book_cd})
	</insert>

	<select id="selectBookForImage" resultType="BookModel">
		SELECT isbn, book_cd FROM
		testlib.bookmst
		where year(rcv_date) is null
	</select>
</mapper>